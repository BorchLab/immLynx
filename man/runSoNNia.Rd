% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runSoNNia.R
\name{runSoNNia}
\alias{runSoNNia}
\title{Run soNNia Selection Analysis}
\usage{
runSoNNia(
  seurat_obj,
  chains = c("TRB", "TRA"),
  background_file,
  organism = "human",
  save_folder = "sonia_output",
  n_epochs = 100,
  return_seurat = TRUE
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing scRepertoire TCR data}

\item{chains}{Which chain to analyze: "TRB" or "TRA". Default is "TRB".}

\item{background_file}{Path to CSV file with background sequences (from generateOLGA)}

\item{organism}{Organism: "human" or "mouse". Default is "human".}

\item{save_folder}{Directory to save soNNia model. Default is "sonia_output".}

\item{n_epochs}{Number of training epochs. Default is 100.}

\item{return_seurat}{If TRUE, adds selection scores to metadata. Default is TRUE.}
}
\value{
If return_seurat=TRUE, returns Seurat object with selection scores in
  metadata. Otherwise returns the soNNia results.
}
\description{
Infer selection pressures on TCRs using soNNia. Requires a
  background dataset of unselected sequences (generated by OLGA).
}
\details{
This function requires a background dataset of unselected TCR sequences, which
can be generated using generateOLGA(). The selected sequences are extracted from
the Seurat object and compared to this background to infer selection pressures.
}
\examples{
\dontrun{
  # Generate background
  background <- generateOLGA(n = 10000, model = "humanTRB")
  write.csv(background, "background.csv", row.names = FALSE)

  # Run soNNia
  seurat_obj <- runSonia(seurat_obj,
                         chains = "TRB",
                         background_file = "background.csv")
}
}
