% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runTCRdist.R
\name{runTCRdist}
\alias{runTCRdist}
\title{Calculate TCR Distances on scRepertoire Data}
\usage{
runTCRdist(
  input,
  chains = "beta",
  organism = "human",
  compute_distances = TRUE,
  add_to_object = FALSE
)
}
\arguments{
\item{input}{A Seurat or SingleCellExperiment object containing scRepertoire TCR data.}

\item{chains}{Character vector specifying chains: "alpha", "beta", or c("alpha", "beta").
Default is "beta".}

\item{organism}{Organism: "human" or "mouse". Default is "human".}

\item{compute_distances}{Logical. Whether to compute full distance matrix. Default TRUE.}

\item{add_to_object}{Logical. If TRUE, attempts to add distance matrix to object
(stored in misc slot for Seurat or metadata for SCE). Default is FALSE due to large
matrix size.}
}
\value{
A list containing:
  \item{distances}{Distance matrices (pw_alpha, pw_beta, pw_cdr3_a_aa, pw_cdr3_b_aa)}
  \item{barcodes}{Cell barcodes corresponding to matrix rows/columns}
  \item{tcr_data}{The formatted TCR data.frame used for analysis}
  If add_to_object=TRUE, returns the input object with distances stored.
}
\description{
This function extracts TCR sequences from a Seurat or
  SingleCellExperiment object with scRepertoire data and calculates pairwise
  TCR distances using tcrdist3.
}
\examples{
data(immLynx_example)
\donttest{
  # Calculate TCR distances for beta chain
  dist_results <- runTCRdist(immLynx_example,
                             chains = "beta")

  # Access the distance matrix
  dist_matrix <- dist_results$distances
  barcodes <- dist_results$barcodes

  # Calculate for both chains
  dist_both <- runTCRdist(immLynx_example,
                          chains = c("alpha", "beta"))

  # Add distances directly to the Seurat object
  seurat_obj <- runTCRdist(immLynx_example,
                           chains = "beta",
                           add_to_object = TRUE)
}
}
