% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runMetaclonotypist.R
\name{runHLAassociation}
\alias{runHLAassociation}
\title{Perform HLA Association Analysis on Metaclones}
\usage{
runHLAassociation(
  metaclone_data,
  hla_data,
  by = "barcode",
  fdr_threshold = 0.05
)
}
\arguments{
\item{metaclone_data}{A data.frame with metaclone assignments, typically from
runMetaclonotypist() with return_seurat=FALSE.}

\item{hla_data}{A data.frame with HLA typing information. Must have a 'barcode'
or 'sample' column for matching and columns for each HLA allele.}

\item{by}{Column name to use for matching between datasets. Default is "barcode".}

\item{fdr_threshold}{FDR threshold for significance. Default is 0.05.}
}
\value{
A data.frame with HLA association results:
  \describe{
    \item{metaclone}{Metaclone identifier}
    \item{hla_allele}{HLA allele tested}
    \item{odds_ratio}{Association odds ratio}
    \item{pvalue}{Raw p-value from Fisher's exact test}
    \item{fdr}{FDR-adjusted p-value}
    \item{significant}{Whether FDR < threshold}
  }
}
\description{
Tests associations between metaclone membership and HLA alleles
  using Fisher's exact test with FDR correction.
}
\examples{
\dontrun{
  metaclones <- runMetaclonotypist(seurat_obj, return_seurat = FALSE)
  hla_results <- runHLAassociation(metaclones, hla_data)
}
}
