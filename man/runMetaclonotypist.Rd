% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runMetaclonotypist.R
\name{runMetaclonotypist}
\alias{runMetaclonotypist}
\title{Run Metaclonotypist for TCR Metaclone Discovery}
\usage{
runMetaclonotypist(
  input,
  chains = c("beta", "alpha"),
  method = c("tcrdist", "sceptr"),
  max_edits = 2,
  max_dist = NULL,
  clustering = c("cc", "leiden", "louvain", "mcl"),
  resolution = 1,
  return_seurat = TRUE,
  column_name = "metaclone"
)
}
\arguments{
\item{input}{A Seurat object with scRepertoire data, or a data.frame with TCR data.}

\item{chains}{Which chain to analyze: "alpha" or "beta". Default is "beta".}

\item{method}{Distance metric for refinement: "tcrdist" (default) or "sceptr".}

\item{max_edits}{Maximum CDR3 edit distance for initial screening. Default is 2.}

\item{max_dist}{Maximum distance threshold for clustering. Default is 20 for
tcrdist, 1.5 for sceptr.}

\item{clustering}{Clustering algorithm: "cc" (connected components, default),
"leiden", "louvain", or "mcl".}

\item{resolution}{Resolution parameter for leiden/louvain clustering. Default is 1.0.}

\item{return_seurat}{Logical. If TRUE and input is Seurat object, adds metaclone
assignments to metadata. Default is TRUE.}

\item{column_name}{Name for the metadata column. Default is "metaclone".}
}
\value{
If return_seurat=TRUE and input is Seurat, returns the object with
  metaclone assignments added to metadata. Otherwise returns a data.frame with:
  \describe{
    \item{barcode}{Cell barcode}
    \item{cdr3_aa}{CDR3 amino acid sequence}
    \item{metaclone}{Metaclone cluster assignment}
    \item{metaclone_size}{Number of cells in the metaclone}
  }
}
\description{
Identifies TCR metaclones (groups of related T cell receptors)
  using the metaclonotypist pipeline. Metaclonotypist uses a two-stage approach:
  fast edit-distance-based screening followed by TCRdist or SCEPTR refinement.
}
\details{
Metaclonotypist identifies groups of related TCRs that may recognize similar
antigens. The algorithm:
1. Uses the Symdel algorithm for fast edit-distance-based candidate identification
2. Refines candidates using TCRdist or SCEPTR similarity metrics
3. Applies graph-based clustering (Leiden by default) to identify metaclones
}
\examples{
data(immLynx_example)
\donttest{
  # Run metaclonotypist on beta chain
  seurat_obj <- runMetaclonotypist(immLynx_example, chains = "beta")

  # Get results as data.frame instead of adding to object
  metaclones <- runMetaclonotypist(immLynx_example,
                                   return_seurat = FALSE)

  # Adjust edit distance threshold
  seurat_obj <- runMetaclonotypist(immLynx_example,
                                   max_edits = 3,
                                   max_dist = 50)
}
}
\references{
Metaclonotypist: \url{https://github.com/qimmuno/metaclonotypist}
}
