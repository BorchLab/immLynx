% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runGLIPH.R
\name{runGLIPH}
\alias{runGLIPH}
\title{Run GLIPH2 Analysis for TCR Specificity Groups}
\usage{
runGLIPH(
  input,
  chains = c("TRB", "beta"),
  local_similarities = TRUE,
  global_similarities = TRUE,
  local_method = c("fisher", "rrs"),
  global_method = c("fisher", "cutoff"),
  motif_length = 3,
  gccutoff = 1,
  vgene_match = FALSE,
  n_cores = 1,
  return_seurat = TRUE,
  column_prefix = "gliph"
)
}
\arguments{
\item{input}{A Seurat object with scRepertoire data, or a data.frame with TCR data.}

\item{chains}{Which chain to analyze. Currently only "TRB"/"beta" is supported
by GLIPH. Default is "TRB".}

\item{local_similarities}{Logical. If TRUE, performs local similarity analysis
(motif-based clustering). Default is TRUE.}

\item{global_similarities}{Logical. If TRUE, performs global similarity analysis
(Hamming distance-based). Default is TRUE.}

\item{local_method}{Method for local enrichment testing: "fisher" (recommended)
or "rrs" (repeated random sampling). Default is "fisher".}

\item{global_method}{Method for global enrichment: "fisher" or "cutoff".
Default is "fisher".}

\item{motif_length}{Length of CDR3 motifs to analyze. Default is 3.}

\item{gccutoff}{Global cluster distance cutoff (for cutoff method). Default is 1.}

\item{vgene_match}{Logical. If TRUE, requires V gene matching in clusters.
Default is FALSE.}

\item{n_cores}{Number of cores for parallel processing. Default is 1.}

\item{return_seurat}{Logical. If TRUE and input is Seurat object, adds cluster
assignments to metadata. Default is TRUE.}

\item{column_prefix}{Prefix for metadata columns. Default is "gliph".}
}
\value{
If return_seurat=TRUE and input is Seurat, returns the object with
  GLIPH cluster assignments. Otherwise returns a list containing:
  \describe{
    \item{clusters}{Data.frame with cluster membership and properties}
    \item{motifs}{Data.frame with enriched motifs}
    \item{network}{Edge list for cluster network}
  }
}
\description{
Identifies TCR specificity groups using the GLIPH (Grouping of
  Lymphocyte Interactions by Paratope Hotspots) algorithm. This function
  provides an interface to the turboGliph R package which implements GLIPH2.
}
\details{
GLIPH identifies TCR specificity groups based on:
\itemize{
  \item Local similarity: Shared CDR3 motifs that are enriched vs. reference
  \item Global similarity: CDR3 sequences within a Hamming distance threshold
}

The turboGliph implementation is significantly faster than the original Perl
version (50-500x depending on dataset size).
}
\section{Requirements}{

This function requires the turboGliph package to be installed:
\code{remotes::install_github("HetzDra/turboGliph")}
}

\examples{
\dontrun{
  # Run GLIPH2 analysis
  seurat_obj <- runGLIPH(seurat_obj, chains = "TRB")

  # Run with V gene matching
  seurat_obj <- runGLIPH(seurat_obj, vgene_match = TRUE)

  # Get full results
  gliph_results <- runGLIPH(seurat_obj, return_seurat = FALSE)
  head(gliph_results$clusters)
}
}
\references{
Glanville et al. (2017). Identifying specificity groups in the T cell receptor
repertoire. Nature, 547(7661), 94-98.
}
\seealso{
\code{\link{runMetaclonotypist}} for an alternative metaclone discovery method
}
